<html>

<head>
<style type="text/css">
.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
},
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Title</title>
</head>

<body>

<p>This is an R HTML document. When you click the <b>Knit HTML</b> button a web page will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(dendextend)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Welcome to dendextend version 0.17.5
## 
## Type ?dendextend to access the overall documentation and
## vignette('dendextend') for the package vignette.
## You can execute a demo of the package via: demo(dendextend)
## 
## More information is available on the dendextend project web-site:
## https://github.com/talgalili/dendextend/
## 
## Contact: <tal.galili@gmail.com>
## Suggestions and bug-reports can be submitted at: https://github.com/talgalili/dendextend/issues
## 
## 			To suppress the this message use:
## 			suppressPackageStartupMessages(library(dendextend))
## 
## 
## Attaching package: 'dendextend'
## 
## The following object is masked from 'package:stats':
## 
##     cutree
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(RColorBrewer)</span>
<span class="hl kwd">getwd</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "/Users/bh/Dropbox/0 - Publications_bh/Shiny/EpiQuant/data/demo_data"
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">epi</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.table</span><span class="hl std">(</span><span class="hl str">'Epi_Sim_Data_58.txt'</span><span class="hl std">,</span> <span class="hl kwc">sep</span> <span class="hl std">=</span> <span class="hl str">'\t'</span><span class="hl std">,</span> <span class="hl kwc">header</span> <span class="hl std">= T)</span>
<span class="hl std">cgf</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.table</span><span class="hl std">(</span><span class="hl str">&quot;Hex-SimTable_58.txt&quot;</span><span class="hl std">,</span> <span class="hl kwc">sep</span><span class="hl std">=</span><span class="hl str">'\t'</span><span class="hl std">,</span> <span class="hl kwc">header</span> <span class="hl std">= T)</span>


<span class="hl kwd">rownames</span><span class="hl std">(epi)</span><span class="hl kwb">&lt;-</span><span class="hl kwd">colnames</span><span class="hl std">(epi)</span>
<span class="hl kwd">rownames</span><span class="hl std">(cgf)</span><span class="hl kwb">&lt;-</span><span class="hl kwd">colnames</span><span class="hl std">(cgf)</span>

<span class="hl std">d_cgf</span><span class="hl kwb">&lt;-</span> <span class="hl kwd">as.dendrogram</span><span class="hl std">(</span><span class="hl kwd">hclust</span><span class="hl std">(</span><span class="hl kwd">dist</span><span class="hl std">(cgf)))</span>
<span class="hl std">d_epi</span><span class="hl kwb">&lt;-</span> <span class="hl kwd">as.dendrogram</span><span class="hl std">(</span><span class="hl kwd">hclust</span><span class="hl std">(</span><span class="hl kwd">dist</span><span class="hl std">(epi)))</span>

<span class="hl kwd">labels</span><span class="hl std">(d_cgf)</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.character</span><span class="hl std">(</span><span class="hl kwd">labels</span><span class="hl std">(d_cgf))</span>
<span class="hl kwd">labels</span><span class="hl std">(d_epi)</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.character</span><span class="hl std">(</span><span class="hl kwd">labels</span><span class="hl std">(d_epi))</span>

<span class="hl std">dendo_random</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">untangle_random_search</span><span class="hl std">(d_cgf, d_epi,</span> <span class="hl kwc">R</span> <span class="hl std">=</span> <span class="hl num">150</span><span class="hl std">)</span>
<span class="hl std">dend_heights</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">heights_per_k.dendrogram</span><span class="hl std">(dendo_random[[</span><span class="hl num">2</span><span class="hl std">]])</span>
<span class="hl std">dendo</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">untangle_step_rotate_1side</span><span class="hl std">(</span><span class="hl kwc">dend1</span> <span class="hl std">= dendo_random[[</span><span class="hl num">2</span><span class="hl std">]],</span> <span class="hl kwc">dend2_fixed</span> <span class="hl std">= dendo_random[[</span><span class="hl num">1</span><span class="hl std">]],</span> <span class="hl kwc">dendextend_heights_per_k.dendrogram</span><span class="hl std">= (dend_heights)[[</span><span class="hl num">1</span><span class="hl std">]],</span> <span class="hl kwc">k_seq</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl opt">:</span><span class="hl num">4</span> <span class="hl std">)</span>

<span class="hl std">dendo[[</span><span class="hl num">1</span><span class="hl std">]]</span> <span class="hl kwb">&lt;-</span>  <span class="hl kwd">color_branches</span><span class="hl std">(dendo[[</span><span class="hl num">1</span><span class="hl std">]],</span> <span class="hl num">6</span><span class="hl std">,</span> <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl kwd">brewer.pal</span><span class="hl std">(</span><span class="hl num">6</span><span class="hl std">,</span> <span class="hl str">&quot;Dark2&quot;</span><span class="hl std">))</span>
<span class="hl std">col_lines_left2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">brewer.pal</span><span class="hl std">(</span><span class="hl num">6</span><span class="hl std">,</span> <span class="hl str">&quot;Dark2&quot;</span><span class="hl std">)[</span><span class="hl kwd">cutree</span><span class="hl std">(dendo[[</span><span class="hl num">1</span><span class="hl std">]],</span> <span class="hl num">6</span><span class="hl std">,</span> <span class="hl kwc">order_clusters_as_data</span> <span class="hl std">= F,</span> <span class="hl kwc">sort_cluster_numbers</span> <span class="hl std">= T)]</span>

<span class="hl kwd">tanglegram</span><span class="hl std">(dendo[[</span><span class="hl num">1</span><span class="hl std">]], dendo[[</span><span class="hl num">2</span><span class="hl std">]],</span> <span class="hl kwc">margin_inner</span> <span class="hl std">=</span> <span class="hl num">5</span><span class="hl std">,</span>
           <span class="hl kwc">color_lines</span> <span class="hl std">= col_lines_left2,</span>
           <span class="hl kwc">lab.cex</span> <span class="hl std">=</span> <span class="hl num">0.75</span><span class="hl std">,</span>
           <span class="hl kwc">main_left</span> <span class="hl std">=</span> <span class="hl str">&quot;Genetic Similarity&quot;</span><span class="hl std">,</span>
           <span class="hl kwc">main_right</span> <span class="hl std">=</span> <span class="hl str">&quot;Epidemiological Similarity&quot;</span><span class="hl std">,</span>
           <span class="hl kwc">sub</span> <span class="hl std">=</span> <span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl str">&quot;Entanglement: &quot;</span><span class="hl std">,</span> <span class="hl kwd">round</span><span class="hl std">(</span><span class="hl kwd">entanglement</span><span class="hl std">(dendo[[</span><span class="hl num">1</span><span class="hl std">]], dendo[[</span><span class="hl num">2</span><span class="hl std">]]),</span> <span class="hl num">2</span><span class="hl std">)),</span>
           <span class="hl kwc">cex_sub</span> <span class="hl std">=</span> <span class="hl num">0.9</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-1.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" class="plot" /></div></div>

<p>You can also embed plots, for example:</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">plot</span><span class="hl std">(cars)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-2.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" class="plot" /></div></div>

</body>
</html>
